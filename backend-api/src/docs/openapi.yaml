openapi: 3.0.0
info:
  title: Drybros Backend API
  version: 0.0.1
  description: API documentation for Drybros backend

servers:
  - url: http://localhost:4000

security:
  - bearerAuth: []

paths:
  /health:
    get:
      summary: Health check
      responses:
        "200":
          description: API health status

  /version:
    get:
      summary: Version info
      responses:
        "200":
          description: App version info

  /franchises:
    get:
      summary: List all franchises (with optional pagination)
      description: |
        Get a list of all franchises. Supports optional pagination via query parameters.
        
        **Query Parameters:**
        - `page` (optional): Page number (default: 1)
        - `limit` (optional): Number of items per page (default: 10, max: 100)
        
        **Without pagination parameters:** Returns all franchises (backward compatible)
        
        **With pagination parameters:** Returns paginated results with metadata
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number (default: 1)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of items per page (default: 10, max: 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
      responses:
        "200":
          description: List of franchises (paginated or all)
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    description: Paginated response (when page/limit provided)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Franchise"
                      pagination:
                        $ref: "#/components/schemas/PaginationMeta"
                  - type: object
                    description: All franchises (when no pagination params)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Franchise"
              examples:
                paginated:
                  summary: Paginated response
                  value:
                    data:
                      - id: "550e8400-e29b-41d4-a716-446655440000"
                        code: "FRN-A1B2C3"
                        name: "Downtown Branch"
                        status: "ACTIVE"
                    pagination:
                      page: 1
                      limit: 10
                      total: 25
                      totalPages: 3
                      hasNext: true
                      hasPrev: false
                all:
                  summary: All franchises (no pagination)
                  value:
                    data:
                      - id: "550e8400-e29b-41d4-a716-446655440000"
                        code: "FRN-A1B2C3"
                        name: "Downtown Branch"
        "400":
          description: Bad request - invalid pagination parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
    post:
      summary: Create a new franchise
      description: |
        Create a new franchise. Only ADMIN role can create franchises.
        
        **Auto-Generated Fields:**
        - `code`: Automatically generated in format FRN-XXXXXX (6 random alphanumeric characters)
        - `id`: Auto-generated UUID
        - `isActive`: Defaults to `true`
        
        **Fields:**
        - `name`: Franchise name (required)
        - `region`: Region where franchise is located (required)
        - `address`: Physical address of the franchise (required)
        - `phone`: Contact number (required, validated format)
        - `inchargeName`: Name of the person in charge (required)
        - `managerEmail`: Email address of the manager (required, will be used to create manager user account)
        - `managerPhone`: Phone number of the manager (required, validated format)
        - `storeImage`: Store image URL (optional)
        
        **Manager Account Creation:**
        - A manager user account will be automatically created with MANAGER role
        - Password will be auto-generated and sent to the manager's email
        - Welcome email will be sent with login credentials
      tags:
        - Franchises
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateFranchiseRequest"
            example:
              name: "Downtown Branch"
              region: "New York"
              address: "123 Main Street, New York, NY 10001"
              phone: "+1234567890"
              inchargeName: "John Smith"
              managerEmail: "john.smith@drybros.com"
              managerPhone: "+1234567891"
              storeImage: "https://example.com/images/store.jpg"
              legalDocumentsCollected: false
      responses:
        "201":
          description: Franchise created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateFranchiseResponse"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN can create franchises)

  /franchises/{id}:
    get:
      summary: Get franchise by ID
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Franchise ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Franchise data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/Franchise"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Franchise not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      summary: Update franchise details
      description: |
        Update franchise details. Only ADMIN and MANAGER roles can update franchises.
        
        All fields are optional - only provide the fields you want to update.
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Franchise ID (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateFranchiseRequest"
            example:
              name: "Updated Downtown Branch"
              region: "New York City"
              address: "456 Updated Street, New York, NY 10002"
              phone: "+1234567891"
              inchargeName: "Jane Doe"
              storeImage: "https://example.com/images/store-updated.jpg"
              legalDocumentsCollected: true
      responses:
        "200":
          description: Franchise updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateFranchiseResponse"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions
        "404":
          description: Franchise not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Soft delete franchise
      description: |
        Soft delete a franchise by setting isActive to false. Only ADMIN role can delete franchises.
        
        This operation does not permanently delete the franchise from the database.
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Franchise ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Franchise deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Franchise deleted successfully"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN can delete)
        "404":
          description: Franchise not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /franchises/{id}/status:
    patch:
      summary: Update franchise status
      description: |
        Update franchise status. Only ADMIN role can update franchise status.
        
        **Available Statuses:**
        - `ACTIVE`: Franchise is active and operational
        - `BLOCKED`: Franchise is blocked (suspended)
        - `TEMPORARILY_CLOSED`: Franchise is temporarily closed
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Franchise ID (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateFranchiseStatusRequest"
            example:
              status: "BLOCKED"
      responses:
        "200":
          description: Franchise status updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateFranchiseResponse"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN can update status)
        "404":
          description: Franchise not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /franchises/{id}/staff:
    get:
      summary: Get staff by franchise ID
      description: |
        Get all staff members associated with a specific franchise.
        
        Returns only active staff members.
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Franchise ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Staff list retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Staff"
        "401":
          description: Unauthorized - missing or invalid token
        "404":
          description: Franchise not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /franchises/{id}/drivers:
    get:
      summary: Get drivers by franchise ID
      description: |
        Get all drivers associated with a specific franchise.
        
        Returns only active drivers.
      tags:
        - Franchises
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Franchise ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Drivers list retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Driver"
        "401":
          description: Unauthorized - missing or invalid token
        "404":
          description: Franchise not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /roles:
    get:
      summary: List all roles
      tags:
        - Roles
      security:
        - bearerAuth: []
      responses:
        "200":
          description: List of roles
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Role"
        "401":
          description: Not authenticated (missing or invalid token)
    post:
      summary: Create a new role
      tags:
        - Roles
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateRoleRequest"
      responses:
        "201":
          description: Role created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "400":
          description: Bad request (e.g., role name already exists)
        "401":
          description: Not authenticated (missing or invalid token)

  /roles/{id}:
    get:
      summary: Get role by ID
      tags:
        - Roles
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
            pattern: "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
      responses:
        "200":
          description: Role data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Role not found
    put:
      summary: Update a role
      tags:
        - Roles
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
            pattern: "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateRoleRequest"
      responses:
        "200":
          description: Role updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "400":
          description: Bad request (e.g., role name already exists)
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Role not found
    delete:
      summary: Delete a role
      tags:
        - Roles
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
            pattern: "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
      responses:
        "204":
          description: Role deleted successfully
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Role not found

  /staff:
    get:
      summary: List staff members
      description: |
        Retrieves a list of staff members with optional pagination.
        
        **Pagination:**
        - Use `page` query parameter to specify the page number (default: 1)
        - Use `limit` query parameter to specify items per page (default: 10, max: 100)
        - If pagination parameters are not provided, returns all staff members (for backward compatibility)
        
        **Example:**
        - `/staff?page=1&limit=10` - Get first 10 staff members
        - `/staff?page=2&limit=20` - Get next 20 staff members (page 2)
        - `/staff` - Get all staff members (no pagination)
      tags:
        - Staff
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number (starts from 1)
          example: 1
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: franchiseId
          in: query
          required: false
          description: Filter staff by franchise ID (UUID)
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
          description: Number of items per page (max 100)
          example: 10
        - name: franchiseId
          in: query
          required: false
          description: Filter staff by franchise ID (UUID)
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: List of staff members (paginated or all)
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: "#/components/schemas/PaginatedStaffResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Staff"
        "400":
          description: Bad request (invalid pagination parameters)
        "401":
          description: Not authenticated (missing or invalid token)
    post:
      summary: Create a new staff member
      description: |
        Creates a new staff member and sends a welcome email with login credentials (email and password).
        The email will be sent to the provided email address.
      tags:
        - Staff
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateStaffRequest"
      responses:
        "201":
          description: Staff member created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateStaffResponse"
        "400":
          description: Bad request (validation error)
        "401":
          description: Not authenticated (missing or invalid token)
        "409":
          description: Email or phone number already in use

  /staff/{id}:
    get:
      summary: Get staff member by ID
      tags:
        - Staff
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Staff member data
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/Staff"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Staff member not found
    patch:
      summary: Update staff member
      description: |
        Updates a staff member's information. Allows updating any field including reassigning to a different franchise.
        Only provided fields will be updated.
      tags:
        - Staff
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateStaffRequest"
      responses:
        "200":
          description: Staff member updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StaffStatusResponse"
        "400":
          description: Bad request (validation error)
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Staff member not found
        "409":
          description: Email or phone number already in use
    delete:
      summary: Delete staff member
      description: |
        Permanently deletes a staff member from the system. This action is logged in the staff history.
        The staff history records are preserved even after deletion.
      tags:
        - Staff
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Staff member deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Staff member deleted successfully"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Staff member not found

  /staff/{id}/status:
    patch:
      summary: Update staff status
      description: |
        Updates a staff member's status. Can be used to fire, suspend, block, or reactivate a staff member.
        
        **Status Options:**
        - `FIRED` - Terminates the staff member
        - `SUSPENDED` - Suspends the staff member (optionally with an end date)
        - `BLOCKED` - Blocks the staff member from accessing the system
        - `ACTIVE` - Reactivates a previously suspended/blocked/fired staff member
        
        **Note:** When status is `SUSPENDED`, you can optionally provide `suspendedUntil` to set an end date.
        If not provided, the suspension is indefinite.
      tags:
        - Staff
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateStaffStatusRequest"
      responses:
        "200":
          description: Staff status updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StaffStatusResponse"
        "400":
          description: Bad request (validation error or invalid status combination)
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Staff member not found

  /staff/{id}/history:
    get:
      summary: Get staff history
      description: |
        Retrieves the complete activity history for a staff member. This includes all actions like:
        - CREATED - When the staff member was created
        - UPDATED - When any field was updated
        - DELETED - When the staff member was deleted
        - STATUS_CHANGED - When the status was changed
        
        Each history entry includes the action, description, who made the change, and the old/new values.
      tags:
        - Staff
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Staff history retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StaffHistoryResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Staff member not found

  /drivers/login:
    post:
      summary: Driver login (Mobile App)
      description: |
        Login endpoint for drivers using their driver code and password.
        Returns access token and refresh token for authentication.
        
        **Note:** This endpoint is public and does not require authentication.
      tags:
        - Drivers
        - Authentication
      security: []  # Public endpoint, no authentication required
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DriverLoginRequest"
            example:
              driverCode: "DRV-3ZSQIA"
              password: "SecurePass123!"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/DriverLoginResponse"
        "400":
          description: Bad request - invalid credentials or validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                error: "Invalid credentials"

  /drivers:
    get:
      summary: List all drivers
      description: |
        Retrieves a list of all drivers in the system. Supports pagination and franchise filtering.
        
        **Pagination:**
        - Use `page` and `limit` query parameters for paginated results
        - Default: `page=1`, `limit=10`
        - Maximum `limit` is 100
        - Only active drivers are returned (soft-deleted drivers are excluded)
        
        **Franchise Filtering:**
        - Use `franchiseId` query parameter to filter drivers by franchise (optional)
        - If provided, only returns drivers belonging to that franchise
        
        **Examples:**
        - `/drivers?page=1&limit=10` - Get first 10 drivers
        - `/drivers?franchiseId=550e8400-e29b-41d4-a716-446655440000` - Get all drivers for a specific franchise
        - `/drivers?page=1&limit=20&franchiseId=550e8400-e29b-41d4-a716-446655440000` - Get paginated drivers for a specific franchise
        
        **Without Pagination:**
        - If no pagination parameters are provided, returns all active drivers
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number (default: 1)
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: limit
          in: query
          required: false
          description: Number of items per page (default: 10, max: 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
            example: 10
        - name: franchiseId
          in: query
          required: false
          description: Filter drivers by franchise ID (UUID)
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: List of drivers retrieved successfully
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    description: Paginated response (when page/limit provided)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Driver"
                      pagination:
                        $ref: "#/components/schemas/PaginationInfo"
                  - type: object
                    description: Non-paginated response (when no pagination params)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Driver"
        "400":
          description: Bad request - invalid pagination parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
  
  /drivers/available/green:
    get:
      summary: Get available drivers with GREEN performance
      description: |
        Retrieves a list of drivers who are:
        - **AVAILABLE** (driverTripStatus = AVAILABLE) - not currently on a trip
        - **GREEN** performance category - excellent performance
        - **ACTIVE** status - active drivers only
        - **Not globally banned** - not banned from the system
        
        Drivers are sorted by performance score (highest first).
        
        **Franchise Filtering:**
        - Use `franchiseId` query parameter to filter drivers by franchise (optional)
        - If provided, only returns available GREEN drivers belonging to that franchise
        
        **Use Cases:**
        - Assigning trips to the best available drivers
        - Finding top-performing drivers for priority assignments
        - Driver selection for high-value trips
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: franchiseId
          in: query
          required: false
          description: Filter drivers by franchise ID (UUID)
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: List of available GREEN drivers retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    description: Array of available drivers with GREEN performance
                    items:
                      allOf:
                        - $ref: "#/components/schemas/Driver"
                        - type: object
                          properties:
                            performance:
                              $ref: "#/components/schemas/DriverPerformanceMetrics"
              example:
                data:
                  - id: "550e8400-e29b-41d4-a716-446655440000"
                    firstName: "John"
                    lastName: "Doe"
                    phone: "+1234567890"
                    email: "john.doe@example.com"
                    driverCode: "DRV-ABC123"
                    status: "ACTIVE"
                    driverTripStatus: "AVAILABLE"
                    currentRating: 4.8
                    performance:
                      category: "GREEN"
                      score: 85
                      rating: 4.8
                      complaintCount: 0
                      totalTrips: 50
                      completedTrips: 48
                      rejectedTrips: 1
                      completionRate: 96.0
                      rejectionRate: 2.0
        "401":
          description: Not authenticated (missing or invalid token)
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  
  /drivers/by-franchises:
    get:
      summary: Get drivers by selected franchises
      description: |
        Retrieves a simplified list of drivers from selected franchises with essential details.
        
        **Required Fields Returned:**
        - `id`: Driver UUID
        - `name`: Full name (firstName + lastName)
        - `phone`: Phone number
        - `availableStatus`: Current trip status (AVAILABLE or ON_TRIP)
        - `performanceStatus`: Performance category (GREEN, YELLOW, or RED)
        - `complaintsNumber`: Number of complaints
        - `franchiseId`: Franchise ID the driver belongs to
        
        **Query Parameters:**
        - `franchiseIds` (optional): Comma-separated list of franchise UUIDs or array
        - `franchiseId` (optional): Single franchise UUID (for backward compatibility)
        
        **Examples:**
        - `/drivers/by-franchises?franchiseIds=uuid1,uuid2,uuid3` - Get drivers from multiple franchises
        - `/drivers/by-franchises?franchiseId=uuid1` - Get drivers from single franchise
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: franchiseIds
          in: query
          required: false
          description: Comma-separated list of franchise UUIDs or array
          schema:
            oneOf:
              - type: array
                items:
                  type: string
                  format: uuid
              - type: string
                pattern: "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}(,[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})*$"
          example: "550e8400-e29b-41d4-a716-446655440000,660e8400-e29b-41d4-a716-446655440001"
        - name: franchiseId
          in: query
          required: false
          description: Single franchise UUID (alternative to franchiseIds)
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: List of drivers retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                          description: Driver UUID
                          example: "550e8400-e29b-41d4-a716-446655440000"
                        name:
                          type: string
                          description: Full name (firstName + lastName)
                          example: "John Doe"
                        phone:
                          type: string
                          description: Phone number
                          example: "+1234567890"
                        availableStatus:
                          type: string
                          enum: ["AVAILABLE", "ON_TRIP"]
                          description: Current trip availability status
                          example: "AVAILABLE"
                        performanceStatus:
                          type: string
                          enum: ["GREEN", "YELLOW", "RED"]
                          description: Performance category
                          example: "GREEN"
                        complaintsNumber:
                          type: integer
                          description: Number of complaints
                          example: 0
                        franchiseId:
                          type: string
                          format: uuid
                          description: Franchise ID
                          example: "550e8400-e29b-41d4-a716-446655440000"
              example:
                data:
                  - id: "550e8400-e29b-41d4-a716-446655440000"
                    name: "John Doe"
                    phone: "+1234567890"
                    availableStatus: "AVAILABLE"
                    performanceStatus: "GREEN"
                    complaintsNumber: 0
                    franchiseId: "550e8400-e29b-41d4-a716-446655440000"
                  - id: "660e8400-e29b-41d4-a716-446655440001"
                    name: "Jane Smith"
                    phone: "+1234567891"
                    availableStatus: "ON_TRIP"
                    performanceStatus: "YELLOW"
                    complaintsNumber: 2
                    franchiseId: "550e8400-e29b-41d4-a716-446655440000"
        "400":
          description: Bad request - missing or invalid franchise IDs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                error: "franchiseIds or franchiseId query parameter is required"
        "401":
          description: Not authenticated (missing or invalid token)
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  
    post:
      summary: Create a new driver
      description: |
        Create a new driver. Only ADMIN and OFFICE_STAFF roles can create drivers.
        
        **Auto-Generated Fields:**
        - `driverCode`: Automatically generated in format DRV-XXXXXX (6 random alphanumeric characters)
        
        **Email Notification:**
        Upon successful creation, a welcome email is automatically sent to the driver's email address containing:
        - Driver code and password for mobile app login
        - Email and password for web portal login
        - Web login link
        
        **Password:**
        The password provided will be used for both app login (with driver code) and web login (with email).
        The password is hashed before storage.
      tags:
        - Drivers
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateDriverRequest"
            example:
              firstName: "John"
              lastName: "Doe"
              phone: "+1234567890"
              email: "john.doe@example.com"
              altPhone: "+1234567891"
              password: "SecurePass123!"
              emergencyContactName: "Jane Doe"
              emergencyContactPhone: "+1234567892"
              emergencyContactRelation: "Spouse"
              address: "123 Main Street"
              city: "New York"
              state: "NY"
              pincode: "10001"
              licenseNumber: "DL1234567890"
              licenseExpDate: "2025-12-31T00:00:00Z"
              bankAccountName: "John Doe"
              bankAccountNumber: "1234567890"
              bankIfscCode: "BANK0001234"
              aadharCard: true
              license: true
              educationCert: false
              previousExp: true
              carTypes: ["MANUAL", "AUTOMATIC"]
              franchiseId: 1
      responses:
        "201":
          description: Driver created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateDriverResponse"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Conflict - phone or email already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN and OFFICE_STAFF can create drivers)

  /drivers/{id}:
    get:
      summary: Get driver by ID
      description: |
        Retrieves detailed information about a specific driver by their ID.
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Driver ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Driver data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/Driver"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Driver not found
    patch:
      summary: Update driver
      description: |
        Update driver details. Main purpose is for reassigning franchises, but can also update other driver information.
        
        **Partial Updates:**
        - All fields are optional
        - Only provided fields will be updated
        - At least one field must be provided
        
        **Franchise Reassignment:**
        - Update `franchiseId` to reassign driver to a different franchise
        
        **Password Update:**
        - If password is provided, it will be hashed before storage
        
        **Validation:**
        - Phone and email must be unique (checked against other drivers)
        - License expiration date must be in the future
        - At least one car type must be provided if `carTypes` is updated
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Driver ID (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateDriverRequest"
            example:
              franchiseId: "550e8400-e29b-41d4-a716-446655440001"
              firstName: "John"
              lastName: "Smith"
              phone: "+1234567890"
              city: "Los Angeles"
              status: "ACTIVE"
      responses:
        "200":
          description: Driver updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UpdateDriverResponse"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN and OFFICE_STAFF can update drivers)
        "404":
          description: Driver not found
        "409":
          description: Conflict - phone or email already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /drivers/{id}:
    delete:
      summary: Soft delete driver
      description: |
        Soft delete a driver by setting `isActive` to `false`. 
        
        **Soft Delete:**
        - Driver is not permanently removed from the database
        - `isActive` field is set to `false`
        - Driver data is preserved for audit/history purposes
        - Can be restored by updating `isActive` back to `true`
        
        **Note:** This is a soft delete operation. The driver record remains in the database but is marked as inactive.
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Driver ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Driver soft deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Driver deleted successfully"
        "400":
          description: Bad request - driver already deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN and OFFICE_STAFF can delete drivers)
        "404":
          description: Driver not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /drivers/{id}/status:
    patch:
      summary: Update driver status
      description: |
        Update driver status for suspend, fire, block, or reactivate operations.
        
        **Status Options:**
        - `ACTIVE`: Reactivate driver (default status)
        - `INACTIVE`: Suspend driver (temporarily disable)
        - `BLOCKED`: Block driver (prevent access)
        - `TERMINATED`: Fire/terminate driver (permanent removal)
        
        **Usage Examples:**
        - To suspend: Set status to `INACTIVE`
        - To fire: Set status to `TERMINATED`
        - To block: Set status to `BLOCKED`
        - To reactivate: Set status to `ACTIVE`
      tags:
        - Drivers
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Driver ID (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateDriverStatusRequest"
            examples:
              suspend:
                summary: Suspend driver
                value:
                  status: "INACTIVE"
              fire:
                summary: Fire driver
                value:
                  status: "TERMINATED"
              block:
                summary: Block driver
                value:
                  status: "BLOCKED"
              reactivate:
                summary: Reactivate driver
                value:
                  status: "ACTIVE"
      responses:
        "200":
          description: Driver status updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UpdateDriverStatusResponse"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Unauthorized - missing or invalid token
        "403":
          description: Forbidden - insufficient permissions (only ADMIN and OFFICE_STAFF can update driver status)
        "404":
          description: Driver not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/register-admin:
    post:
      summary: Register a new admin user
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterAdminRequest"
      responses:
        "201":
          description: Admin registered successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegisterAdminResponse"
        "400":
          description: Bad request (validation error)
        "409":
          description: Email already in use

  /auth/login:
    post:
      summary: Login user
      description: |
        Authenticates a user and returns access and refresh tokens.
        
        **Rate Limiting & Account Lockout:**
        The system implements escalating account lockout to prevent brute-force attacks:
        - After **5 incorrect password attempts**, the account is locked for **5 minutes**
        - After the lockout expires, if **2 more incorrect attempts** occur, the account is locked for **10 minutes**
        - Each subsequent threshold (every 2 more incorrect attempts) doubles the lockout duration
        - Maximum lockout duration is capped at **30 minutes**
        - Failed attempts counter resets to 0 on successful login
        
        **Lockout Behavior:**
        - If an account is locked, login attempts will return a 429 error with the remaining lockout time
        - The lockout check happens before password verification
        - Successful login automatically resets the failed attempts counter and unlocks the account
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "400":
          description: Invalid credentials (incorrect email or password)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "429":
          description: Account temporarily locked due to multiple failed login attempts
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                error: "Account is temporarily locked due to multiple failed login attempts. Please try again in 5 minute(s)."

  /auth/forgot-password:
    post:
      summary: Request password reset
      description: Sends a password reset link to the user's email address. Returns an error if the email does not exist in the system or if the account is inactive.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequest"
      responses:
        "200":
          description: Password reset email sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ForgotPasswordResponse"
        "400":
          description: Bad request (validation error or account is inactive)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Email address not found in the system
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /auth/reset-password:
    post:
      summary: Reset password with token
      description: Resets the user's password using the token received via email. Token expiration is configurable (default: 1 hour).
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequest"
      responses:
        "200":
          description: Password reset successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResetPasswordResponse"
        "400":
          description: Bad request (invalid or expired token, validation error)

  /auth/refresh-token:
    post:
      summary: Refresh access token
      description: Generates a new access token and refresh token using a valid refresh token. Refresh token expires in 8 hours.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenRequest"
      responses:
        "200":
          description: Tokens refreshed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "400":
          description: Bad request (invalid or expired refresh token, validation error)

  /auth/logout:
    post:
      summary: Logout user
      description: Logs out the current authenticated user. Since we use stateless JWT tokens, logout is primarily client-side (token removal). The server confirms the logout action.
      tags:
        - Authentication
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Logged out successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogoutResponse"
        "401":
          description: Not authenticated (missing or invalid token)

  /auth/me:
    get:
      summary: Get current user information
      description: Returns the current authenticated user's information based on the JWT token.
      tags:
        - Authentication
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Current user information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CurrentUserResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: User not found
        "400":
          description: User account is inactive

  /customers:
    post:
      summary: Create a customer
      tags:
        - Customers
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCustomerRequest"
      responses:
        "201":
          description: Customer created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomerResponse"
        "401":
          description: Not authenticated (missing or invalid token)

  /trips:
    get:
      summary: Get all trips
      description: |
        Get a list of all trips. Supports optional pagination via query parameters.

        **Query Parameters:**
        - `page` (optional): Page number (default: 1)
        - `limit` (optional): Number of items per page (default: 10, max: 100)

        **Without pagination parameters:** Returns all trips (backward compatible)

        **With pagination parameters:** Returns paginated results with metadata
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number (default: 1)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of items per page (default: 10, max: 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
      responses:
        "200":
          description: List of trips (paginated or all)
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    description: Paginated response (when page/limit provided)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Trip"
                      pagination:
                        $ref: "#/components/schemas/PaginationMeta"
                  - type: object
                    description: All trips (when no pagination params)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Trip"
        "401":
          description: Not authenticated (missing or invalid token)
    post:
      summary: Create a trip
      tags:
        - Trips
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTripRequest"
      responses:
        "201":
          description: Trip created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TripResponse"
        "401":
          description: Not authenticated (missing or invalid token)

  /trips/driver/assigned:
    get:
      summary: Get trips assigned to driver
      description: |
        Get a list of trips that are assigned to a specific driver.
        
        Returns trips with status: ASSIGNED, DRIVER_ACCEPTED, TRIP_STARTED, or TRIP_PROGRESS.
        
        **Query Parameters:**
        - `driverId` (required): Driver UUID to get assigned trips for
        
        **Use Cases:**
        - Driver mobile app to see their assigned trips
        - Driver dashboard to view active trips
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: driverId
          in: query
          required: true
          description: Driver UUID
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: List of assigned trips retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/TripResponse"
        "400":
          description: Bad request - missing or invalid driver ID
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/unassigned:
    get:
      summary: Get unassigned trips
      description: |
        Get a list of trips with PENDING or NOT_ASSIGNED status (trips without a driver assigned).
        Supports optional pagination via query parameters.

        **Query Parameters:**
        - `page` (optional): Page number (default: 1)
        - `limit` (optional): Number of items per page (default: 10, max: 100)

        **Without pagination parameters:** Returns all unassigned trips

        **With pagination parameters:** Returns paginated results with metadata
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number (default: 1)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of items per page (default: 10, max: 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
      responses:
        "200":
          description: List of unassigned trips (paginated or all)
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    description: Paginated response (when page/limit provided)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Trip"
                      pagination:
                        $ref: "#/components/schemas/PaginationMeta"
                  - type: object
                    description: All unassigned trips (when no pagination params)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Trip"
        "401":
          description: Not authenticated (missing or invalid token)

  /trips/{id}:
    get:
      summary: Get trip by ID
      description: |
        Get detailed information about a specific trip by its ID (UUID).
        
        Returns the trip with all related data including:
        - Customer information
        - Franchise information
        - Driver information (if assigned)
        - Trip status and details
        - Payment information
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip ID (UUID)
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: Trip retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/Trip"
        "400":
          description: Bad request - invalid UUID format
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Trip not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/phase1:
    post:
      summary: Create trip - Phase 1 (Customer Data Collection)
      description: |
        Create a trip in Phase 1 with customer data collection. This endpoint:
        - Automatically checks if customer exists by phone number
        - Creates new customer if not found, or updates existing customer with new information
        - Creates trip with REQUESTED status (ready for driver assignment in Phase 2)
        - Stores pickup and destination locations from Google Places API
        - Handles car preferences (gear type and category)
        - Sets confirmation flags (details reconfirmed, fare discussed, price accepted)
      tags:
        - Trips
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTripPhase1Request"
            example:
              customerName: "John Doe"
              customerPhone: "+1234567890"
              customerEmail: "john.doe@example.com"
              pickupLocation: "ChIJN1t_tDeuEmsRUsoyG83frY4"
              pickupAddress: "123 Main Street, New York, NY 10001"
              pickupLocationNote: "Near the blue building, entrance on the right"
              destinationLocation: "ChIJN1t_tDeuEmsRUsoyG83frY5"
              destinationAddress: "456 Oak Avenue, New York, NY 10002"
              destinationNote: "Building entrance, ring doorbell"
              franchiseId: "550e8400-e29b-41d4-a716-446655440000"
              tripType: "CITY_ROUND"
              carGearType: "MANUAL"
              carType: "PREMIUM"
              tripDate: "2024-01-20"
              tripTime: "14:30"
              isDetailsReconfirmed: true
              isFareDiscussed: true
              isPriceAccepted: true
      responses:
        "201":
          description: Trip created successfully in Phase 1
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateTripPhase1Response"
              example:
                data:
                  trip:
                    id: "660e8400-e29b-41d4-a716-446655440000"
                    franchiseId: "550e8400-e29b-41d4-a716-446655440000"
                    customerId: 1
                    customerName: "John Doe"
                    customerPhone: "+1234567890"
                    customerEmail: "john.doe@example.com"
                    tripType: "CITY_ROUND"
                    status: "REQUESTED"
                    pickupLocation: "ChIJN1t_tDeuEmsRUsoyG83frY4"
                    pickupAddress: "123 Main Street, New York, NY 10001"
                    pickupLocationNote: "Near the blue building, entrance on the right"
                    dropLocation: "ChIJN1t_tDeuEmsRUsoyG83frY5"
                    dropAddress: "456 Oak Avenue, New York, NY 10002"
                    dropLocationNote: "Building entrance, ring doorbell"
                    carType: '{"gearType":"MANUAL","category":"PREMIUM"}'
                    scheduledAt: "2024-01-20T14:30:00Z"
                    isDetailsReconfirmed: true
                    isFareDiscussed: true
                    isPriceAccepted: true
                    baseAmount: 0
                    extraAmount: 0
                    totalAmount: 0
                    finalAmount: 0
                    paymentStatus: "PENDING"
                    createdAt: "2024-01-20T10:00:00Z"
                    updatedAt: "2024-01-20T10:00:00Z"
                  customer:
                    id: 1
                    name: "John Doe"
                    phone: "+1234567890"
                    email: "john.doe@example.com"
                    isExisting: false
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                missingCustomerName:
                  summary: Missing customer name
                  value:
                    error: "Customer name is required"
                missingCustomerPhone:
                  summary: Missing customer phone
                  value:
                    error: "Customer phone number is required"
                missingPickupLocation:
                  summary: Missing pickup location
                  value:
                    error: "Pickup location is required"
                missingDestinationLocation:
                  summary: Missing destination location
                  value:
                    error: "Destination location is required"
                invalidCarGearType:
                  summary: Invalid car gear type
                  value:
                    error: "Invalid car gear type"
                invalidCarType:
                  summary: Invalid car type category
                  value:
                    error: "Invalid car type category"
                invalidTripType:
                  summary: Invalid trip type
                  value:
                    error: "Invalid trip type"
        "401":
          description: Not authenticated (missing or invalid token)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/{id}/driver-accept:
    patch:
      summary: Driver accepts a trip
      description: |
        Driver accepts a trip that has been assigned to them.
        
        **Prerequisites:**
        - Trip must be in ASSIGNED status
        - Trip must be assigned to the driver making the request
        
        **Status Change:**
        - ASSIGNED  DRIVER_ACCEPTED
        
        **Request Body:**
        - `driverId` (required): Driver UUID (can also be passed as query parameter)
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip UUID
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
        - name: driverId
          in: query
          required: false
          description: Driver UUID (alternative to body parameter)
          schema:
            type: string
            format: uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                driverId:
                  type: string
                  format: uuid
                  description: Driver UUID
                  example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: Trip accepted by driver
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/TripResponse"
        "400":
          description: Bad request - missing driverId or invalid trip status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - trip not assigned to this driver
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/{id}/driver-reject:
    patch:
      summary: Driver rejects a trip
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                driverId:
                  type: integer
              required:
                - driverId
      responses:
        "200":
          description: Trip rejected by driver
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TripResponse"
        "401":
          description: Not authenticated (missing or invalid token)

  /trips/{id}/generate-start-otp:
    post:
      summary: Generate start OTP for a trip
      description: |
        Generate a 4-digit OTP required to start a trip.
        
        **Prerequisites:**
        - Trip must be in DRIVER_ACCEPTED status
        - Trip must be assigned to the driver making the request
        
        **OTP Usage:**
        - The generated OTP must be used in the start trip endpoint
        - OTP is typically sent via SMS/WhatsApp to the customer
        
        **Request Body:**
        - `driverId` (required): Driver UUID (can also be passed as query parameter)
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip UUID
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
        - name: driverId
          in: query
          required: false
          description: Driver UUID (alternative to body parameter)
          schema:
            type: string
            format: uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                driverId:
                  type: string
                  format: uuid
                  description: Driver UUID
                  example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: Start OTP generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      tripId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440000"
                      otp:
                        type: string
                        description: 4-digit OTP
                        example: "1234"
        "400":
          description: Bad request - missing driverId or invalid trip status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - trip not assigned to this driver
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/{id}/start:
    patch:
      summary: Start trip with OTP
      description: |
        Start a trip by providing the OTP generated from the generate-start-otp endpoint.
        
        **Prerequisites:**
        - Trip must be in ASSIGNED or DRIVER_ACCEPTED status
        - Trip must be assigned to the driver making the request
        - Valid OTP must be provided
        
        **Status Change:**
        - ASSIGNED/DRIVER_ACCEPTED  TRIP_STARTED
        - Driver trip status  ON_TRIP
        
        **Request Body:**
        - `driverId` (required): Driver UUID (can also be passed as query parameter)
        - `otp` (required): 4-digit OTP from generate-start-otp endpoint
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip UUID
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
        - name: driverId
          in: query
          required: false
          description: Driver UUID (alternative to body parameter)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                driverId:
                  type: string
                  format: uuid
                  description: Driver UUID
                  example: "550e8400-e29b-41d4-a716-446655440000"
                otp:
                  type: string
                  description: 4-digit OTP from generate-start-otp
                  example: "1234"
              required:
                - otp
      responses:
        "200":
          description: Trip started successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/TripResponse"
        "400":
          description: Bad request - missing parameters or invalid OTP
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - trip not assigned to this driver
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/{id}/generate-end-otp:
    post:
      summary: Generate end OTP for a trip
      description: |
        Generate a 4-digit OTP required to end a trip.
        
        **Prerequisites:**
        - Trip must be in TRIP_STARTED, TRIP_PROGRESS, or IN_PROGRESS status
        - Trip must be assigned to the driver making the request
        
        **OTP Usage:**
        - The generated OTP must be used in the end trip endpoint
        - OTP is typically sent via SMS/WhatsApp to the customer
        
        **Request Body:**
        - `driverId` (required): Driver UUID (can also be passed as query parameter)
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip UUID
          schema:
            type: string
            format: uuid
            example: "550e8400-e29b-41d4-a716-446655440000"
        - name: driverId
          in: query
          required: false
          description: Driver UUID (alternative to body parameter)
          schema:
            type: string
            format: uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                driverId:
                  type: string
                  format: uuid
                  description: Driver UUID
                  example: "550e8400-e29b-41d4-a716-446655440000"
      responses:
        "200":
          description: End OTP generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      tripId:
                        type: string
                        format: uuid
                        example: "550e8400-e29b-41d4-a716-446655440000"
                      otp:
                        type: string
                        description: 4-digit OTP
                        example: "5678"
        "400":
          description: Bad request - missing driverId or invalid trip status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - trip not assigned to this driver
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trips/{id}/end:
    patch:
      summary: End trip with OTP and payment
      tags:
        - Trips
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EndTripRequest"
      responses:
        "200":
          description: Trip completed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TripResponse"
        "401":
          description: Not authenticated (missing or invalid token)

  /trip-types:
    get:
      summary: List all trip types (with optional pagination)
      description: |
        Get all active trip type configurations. Supports optional pagination via query parameters.
        
        **Query Parameters:**
        - `page` (optional): Page number (default: 1)
        - `limit` (optional): Number of items per page (default: 10, max: 100)
        
        **Without pagination parameters:** Returns all trip types (backward compatible)
        
        **With pagination parameters:** Returns paginated results with metadata
      tags:
        - Trip Types
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number (default: 1)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of items per page (default: 10, max: 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
      responses:
        "200":
          description: List of trip types (paginated or all)
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    description: Paginated response (when page/limit provided)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/TripTypeConfig"
                      pagination:
                        $ref: "#/components/schemas/PaginationMeta"
                  - type: object
                    description: All trip types (when no pagination params)
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/TripTypeConfig"
              examples:
                paginated:
                  summary: Paginated response
                  value:
                    data:
                      - id: "550e8400-e29b-41d4-a716-446655440000"
                        name: "City Round Trip"
                        basePrice: 400
                        baseHour: 3
                        extraPerHour: 100
                        extraPerHalfHour: 50
                        status: "ACTIVE"
                    pagination:
                      page: 1
                      limit: 10
                      total: 4
                      totalPages: 1
                      hasNext: false
                      hasPrev: false
                all:
                  summary: All trip types (no pagination)
                  value:
                    data:
                      - id: "550e8400-e29b-41d4-a716-446655440000"
                        name: "CITY_ROUND"
                        basePrice: 400
                        extraPerHour: 100
        "400":
          description: Bad request - invalid pagination parameters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
    post:
      summary: Create a new trip type
      description: |
        Create a new trip type configuration with pricing details.
        Only ADMIN and MANAGER roles can create trip types.
        
        **Required Fields:**
        - `name`: Trip type name (any string - user-defined)
        - `basePrice`: Base price for the trip
        - `baseHour`: Base hours included in the base price
        - `extraPerHour`: Extra charge per hour
        
        **Optional Fields:**
        - `extraPerHalfHour`: Extra charge for 30 minutes
        - `description`: Description of the trip type
      tags:
        - Trip Types
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTripTypeRequest"
            example:
              name: "City Round Trip"
              basePrice: 400
              baseHour: 3
              distance: 20
              extraPerHour: 100
              extraPerHalfHour: 50
              description: "City round trip pricing"
      responses:
        "201":
          description: Trip type created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/TripTypeConfig"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                emptyName:
                  summary: Empty trip type name
                  value:
                    error: "Trip type name is required and cannot be empty"
                duplicateTripType:
                  summary: Trip type already exists
                  value:
                    error: "Trip type configuration already exists for: City Round Trip"
                invalidPrice:
                  summary: Invalid price
                  value:
                    error: "Base price must be a positive number"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - insufficient permissions (only ADMIN and MANAGER can create)

  /trip-types/{id}:
    get:
      summary: Get trip type by ID
      description: |
        Get a specific trip type configuration by its ID.
        Any authenticated user can view trip types.
      tags:
        - Trip Types
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip type ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Trip type retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/TripTypeConfig"
        "401":
          description: Not authenticated (missing or invalid token)
        "404":
          description: Trip type not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      summary: Update trip type
      description: |
        Update an existing trip type configuration.
        Only ADMIN and MANAGER roles can update trip types.
        All fields are optional - only provide the fields you want to update.
      tags:
        - Trip Types
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip type ID (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateTripTypeRequest"
            example:
              basePrice: 450
              baseHour: 3
              distance: 25
              extraPerHour: 120
              extraPerHalfHour: 60
      responses:
        "200":
          description: Trip type updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: "#/components/schemas/TripTypeConfig"
        "400":
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - insufficient permissions
        "404":
          description: Trip type not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      summary: Delete trip type
      description: |
        Soft delete a trip type by setting its status to INACTIVE.
        Only ADMIN and MANAGER roles can delete trip types.
      tags:
        - Trip Types
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Trip type ID (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Trip type deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Trip type deleted successfully"
        "401":
          description: Not authenticated (missing or invalid token)
        "403":
          description: Forbidden - insufficient permissions
        "404":
          description: Trip type not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

components:
  schemas:
    CreateCustomerRequest:
      type: object
      properties:
        fullName:
          type: string
        phone:
          type: string
        email:
          type: string
        city:
          type: string
        notes:
          type: string
        franchiseId:
          type: integer
      required:
        - fullName
        - phone
        - franchiseId

    Customer:
      type: object
      properties:
        id:
          type: integer
        fullName:
          type: string
        phone:
          type: string
        email:
          type: string
        city:
          type: string
        notes:
          type: string
        franchiseId:
          type: integer

    CustomerResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/Customer"

    CreateTripRequest:
      type: object
      properties:
        franchiseId:
          type: integer
        driverId:
          type: integer
        customerId:
          type: integer
        tripType:
          type: string
          enum: [CITY_ROUND, CITY_DROPOFF, LONG_ROUND, LONG_DROPOFF]
        pickupLocation:
          type: string
        dropLocation:
          type: string
        scheduledAt:
          type: string
          format: date-time
        baseAmount:
          type: number
        extraAmount:
          type: number
      required:
        - franchiseId
        - driverId
        - customerId
        - tripType
        - pickupLocation
        - baseAmount

    CreateTripPhase1Request:
      type: object
      description: |
        Request body for Phase 1 trip creation with customer data collection.
        This endpoint automatically handles customer creation/update based on phone number.
      properties:
        customerName:
          type: string
          description: Full name of the customer
          example: "John Doe"
          minLength: 1
          maxLength: 100
        customerPhone:
          type: string
          description: Customer phone number (used to check if customer exists)
          example: "+1234567890"
          pattern: "^[+]?[(]?[0-9]{1,4}[)]?[-\\s.]?[(]?[0-9]{1,4}[)]?[-\\s.]?[0-9]{1,9}$"
        customerEmail:
          type: string
          format: email
          description: Customer email address (optional)
          example: "john.doe@example.com"
          nullable: true
        pickupLocation:
          type: string
          description: Google Place ID or coordinates for pickup location
          example: "ChIJN1t_tDeuEmsRUsoyG83frY4"
          minLength: 1
        pickupAddress:
          type: string
          description: Full address for pickup location
          example: "123 Main Street, New York, NY 10001"
          minLength: 1
          maxLength: 500
        pickupLocationNote:
          type: string
          description: Additional notes for pickup location (landmarks, details)
          example: "Near the blue building, entrance on the right"
          nullable: true
          maxLength: 500
        destinationLocation:
          type: string
          description: Google Place ID or coordinates for destination location
          example: "ChIJN1t_tDeuEmsRUsoyG83frY5"
          minLength: 1
        destinationAddress:
          type: string
          description: Full address for destination location
          example: "456 Oak Avenue, New York, NY 10002"
          minLength: 1
          maxLength: 500
        destinationNote:
          type: string
          description: Additional notes for destination location (landmarks, details)
          example: "Building entrance, ring doorbell"
          nullable: true
          maxLength: 500
        franchiseId:
          type: string
          format: uuid
          description: Franchise ID (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        tripType:
          type: string
          enum: [CITY_ROUND, CITY_DROPOFF, LONG_ROUND, LONG_DROPOFF]
          description: Type of trip
          example: "CITY_ROUND"
        distance:
          type: number
          description: Distance in kilometers (optional, can be calculated later)
          example: 15.5
          nullable: true
          minimum: 0
        distanceScope:
          type: string
          description: Distance scope identifier (optional)
          example: "LOCAL"
          nullable: true
        carGearType:
          type: string
          enum: [MANUAL, AUTOMATIC]
          description: Car gear type preference
          example: "MANUAL"
        carType:
          type: string
          enum: [PREMIUM, LUXURY, NORMAL]
          description: Car type category preference
          example: "PREMIUM"
        tripDate:
          type: string
          format: date
          description: Trip date in YYYY-MM-DD format
          example: "2024-01-20"
        tripTime:
          type: string
          pattern: "^([0-1][0-9]|2[0-3]):[0-5][0-9]$"
          description: Trip time in HH:mm format (24-hour)
          example: "14:30"
        isDetailsReconfirmed:
          type: boolean
          description: Flag indicating if trip details have been reconfirmed with customer
          example: true
          default: false
        isFareDiscussed:
          type: boolean
          description: Flag indicating if base fare has been discussed with customer
          example: true
          default: false
        isPriceAccepted:
          type: boolean
          description: Flag indicating if customer has accepted the price
          example: true
          default: false
      required:
        - customerName
        - customerPhone
        - pickupLocation
        - pickupAddress
        - destinationLocation
        - destinationAddress
        - franchiseId
        - tripType
        - carGearType
        - carType
        - tripDate
        - tripTime
        - isDetailsReconfirmed
        - isFareDiscussed
        - isPriceAccepted

    CreateTripPhase1Response:
      type: object
      description: Response for Phase 1 trip creation
      properties:
        data:
          type: object
          properties:
            trip:
              type: object
              description: Created trip object
              properties:
                id:
                  type: string
                  format: uuid
                  description: Trip ID (UUID)
                  example: "660e8400-e29b-41d4-a716-446655440000"
                franchiseId:
                  type: string
                  format: uuid
                  description: Franchise ID
                  example: "550e8400-e29b-41d4-a716-446655440000"
                customerId:
                  type: integer
                  nullable: true
                  description: Customer ID (if customer was found/created)
                  example: 1
                customerName:
                  type: string
                  description: Customer name
                  example: "John Doe"
                customerPhone:
                  type: string
                  description: Customer phone number
                  example: "+1234567890"
                customerEmail:
                  type: string
                  nullable: true
                  description: Customer email
                  example: "john.doe@example.com"
                tripType:
                  type: string
                  enum: [CITY_ROUND, CITY_DROPOFF, LONG_ROUND, LONG_DROPOFF]
                  description: Trip type
                  example: "CITY_ROUND"
                status:
                  type: string
                  enum: [REQUESTED, ASSIGNED, DRIVER_ON_THE_WAY, IN_PROGRESS, COMPLETED, CANCELLED_BY_CUSTOMER, CANCELLED_BY_OFFICE, REJECTED_BY_DRIVER, DRIVER_ACCEPTED]
                  description: Trip status (always REQUESTED for Phase 1)
                  example: "REQUESTED"
                pickupLocation:
                  type: string
                  description: Google Place ID or coordinates for pickup
                  example: "ChIJN1t_tDeuEmsRUsoyG83frY4"
                pickupAddress:
                  type: string
                  description: Full pickup address
                  example: "123 Main Street, New York, NY 10001"
                pickupLocationNote:
                  type: string
                  nullable: true
                  description: Pickup location notes
                  example: "Near the blue building, entrance on the right"
                dropLocation:
                  type: string
                  nullable: true
                  description: Google Place ID or coordinates for destination
                  example: "ChIJN1t_tDeuEmsRUsoyG83frY5"
                dropAddress:
                  type: string
                  nullable: true
                  description: Full destination address
                  example: "456 Oak Avenue, New York, NY 10002"
                dropLocationNote:
                  type: string
                  nullable: true
                  description: Destination location notes
                  example: "Building entrance, ring doorbell"
                carType:
                  type: string
                  description: Car type stored as JSON string with gearType and category
                  example: '{"gearType":"MANUAL","category":"PREMIUM"}'
                scheduledAt:
                  type: string
                  format: date-time
                  nullable: true
                  description: Scheduled trip date and time
                  example: "2024-01-20T14:30:00Z"
                isDetailsReconfirmed:
                  type: boolean
                  description: Details reconfirmed flag
                  example: true
                isFareDiscussed:
                  type: boolean
                  description: Fare discussed flag
                  example: true
                isPriceAccepted:
                  type: boolean
                  description: Price accepted flag
                  example: true
                baseAmount:
                  type: integer
                  description: Base amount (0 for Phase 1)
                  example: 0
                extraAmount:
                  type: integer
                  description: Extra amount (0 for Phase 1)
                  example: 0
                totalAmount:
                  type: integer
                  description: Total amount (0 for Phase 1)
                  example: 0
                finalAmount:
                  type: integer
                  description: Final amount (0 for Phase 1)
                  example: 0
                paymentStatus:
                  type: string
                  enum: [PENDING, COMPLETED, PAID, PARTIALLY_PAID]
                  description: Payment status (always PENDING for Phase 1)
                  example: "PENDING"
                createdAt:
                  type: string
                  format: date-time
                  description: Creation timestamp
                  example: "2024-01-20T10:00:00Z"
                updatedAt:
                  type: string
                  format: date-time
                  description: Last update timestamp
                  example: "2024-01-20T10:00:00Z"
            customer:
              type: object
              description: Customer information with existence flag
              properties:
                id:
                  type: integer
                  description: Customer ID
                  example: 1
                name:
                  type: string
                  description: Customer name
                  example: "John Doe"
                phone:
                  type: string
                  description: Customer phone number
                  example: "+1234567890"
                email:
                  type: string
                  nullable: true
                  description: Customer email
                  example: "john.doe@example.com"
                isExisting:
                  type: boolean
                  description: Whether the customer already existed (true) or was newly created (false)
                  example: false

    Trip:
      type: object
      properties:
        id:
          type: integer
        franchiseId:
          type: integer
        driverId:
          type: integer
          nullable: true
        customerId:
          type: integer
        customerName:
          type: string
        customerPhone:
          type: string
        tripType:
          type: string
        status:
          type: string
        pickupLocation:
          type: string
        dropLocation:
          type: string
          nullable: true
        scheduledAt:
          type: string
          format: date-time
          nullable: true
        startedAt:
          type: string
          format: date-time
          nullable: true
        endedAt:
          type: string
          format: date-time
          nullable: true
        baseAmount:
          type: number
        extraAmount:
          type: number
        totalAmount:
          type: number
        finalAmount:
          type: number
        paymentStatus:
          type: string
        paymentMode:
          type: string
          nullable: true
        paymentReference:
          type: string
          nullable: true

    TripResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/Trip"

    StartOtpResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            tripId:
              type: integer
            otp:
              type: string

    EndOtpResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            tripId:
              type: integer
            otp:
              type: string

    StartTripRequest:
      type: object
      properties:
        driverId:
          type: integer
        otp:
          type: string
      required:
        - driverId
        - otp

    EndTripRequest:
      type: object
      properties:
        driverId:
          type: integer
        otp:
          type: string
        finalAmount:
          type: number
        paymentStatus:
          type: string
          enum: [PENDING, COMPLETED, PAID, PARTIALLY_PAID]
        paymentMode:
          type: string
          enum: [UPI, IN_HAND, CASH, CARD, OTHER]
        paymentReference:
          type: string
        overrideReason:
          type: string
      required:
        - driverId
        - otp
        - finalAmount
        - paymentStatus
        - paymentMode

    TripTypeConfig:
      type: object
      description: Trip type configuration model
      properties:
        id:
          type: string
          format: uuid
          description: Configuration ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        name:
          type: string
          description: Trip type name (user-defined, any string)
          example: "City Round Trip"
        description:
          type: string
          nullable: true
          description: Configuration description
          example: "City round trip pricing"
        basePrice:
          type: number
          description: Base price
          example: 400
        baseHour:
          type: number
          nullable: true
          description: Base hours included in the base price
          example: 3
        distance:
          type: number
          nullable: true
          description: Base distance in km
          example: 20
        extraPerHour:
          type: number
          description: Extra charge per hour
          example: 100
        extraPerHalfHour:
          type: number
          nullable: true
          description: Extra charge per half hour (30 minutes)
          example: 50
        status:
          type: string
          enum: [ACTIVE, INACTIVE]
          description: Configuration status
          example: "ACTIVE"
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp

    CreateTripTypeRequest:
      type: object
      description: Request body for creating a new trip type
      required:
        - name
        - basePrice
        - baseHour
        - extraPerHour
      properties:
        name:
          type: string
          description: Trip type name (user-defined, any string)
          example: "City Round Trip"
          minLength: 1
          maxLength: 100
        basePrice:
          type: number
          description: Base price (must be positive)
          example: 400
          minimum: 0
        baseHour:
          type: number
          description: Base hours included in the base price (must be positive)
          example: 3
          minimum: 0
        extraPerHour:
          type: number
          description: Extra charge per hour (must be positive)
          example: 100
          minimum: 0
        extraPerHalfHour:
          type: number
          nullable: true
          description: Extra charge for 30 minutes (optional)
          example: 50
          minimum: 0
        distance:
          type: number
          nullable: true
          description: Base distance in km (optional)
          example: 20
          minimum: 0
        description:
          type: string
          nullable: true
          description: Description of the trip type
          example: "City round trip pricing"
          maxLength: 500

    UpdateTripTypeRequest:
      type: object
      description: Request body for updating a trip type. All fields are optional.
      properties:
        name:
          type: string
          description: Trip type name (user-defined, any string)
          example: "City Round Trip"
          minLength: 1
          maxLength: 100
        basePrice:
          type: number
          description: Base price (must be positive)
          example: 450
          minimum: 0
        baseHour:
          type: number
          description: Base hours included in the base price (must be positive)
          example: 3
          minimum: 0
        extraPerHour:
          type: number
          description: Extra charge per hour (must be positive)
          example: 120
          minimum: 0
        extraPerHalfHour:
          type: number
          nullable: true
          description: Extra charge for 30 minutes
          example: 60
          minimum: 0
        distance:
          type: number
          nullable: true
          description: Base distance in km (optional)
          example: 20
          minimum: 0
        description:
          type: string
          nullable: true
          description: Description of the trip type
          maxLength: 500

    CreateRoleRequest:
      type: object
      properties:
        name:
          type: string
          description: Role name (e.g., ADMIN, DRIVER, STAFF, CUSTOMER)
          example: ADMIN
        description:
          type: string
          description: Optional description of the role
          example: Administrator with full system access
        isActive:
          type: boolean
          description: Whether the role is active
          default: true
      required:
        - name

    UpdateRoleRequest:
      type: object
      properties:
        name:
          type: string
          description: Role name
          example: ADMIN
        description:
          type: string
          description: Optional description of the role
          example: Administrator with full system access
        isActive:
          type: boolean
          description: Whether the role is active
      required: []

    Role:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Role ID (UUID)
        name:
          type: string
          description: Role name
          example: ADMIN
        description:
          type: string
          nullable: true
          description: Role description
        isActive:
          type: boolean
          description: Whether the role is active
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp

    RoleResponse:
      type: object
      properties:
        data:
          $ref: "#/components/schemas/Role"

    RegisterAdminRequest:
      type: object
      properties:
        name:
          type: string
          description: Full name of the admin
          example: John Doe
          minLength: 1
          maxLength: 100
        email:
          type: string
          format: email
          description: Email address (must be unique)
          example: admin@drybros.com
        password:
          type: string
          format: password
          description: Password (minimum 8 characters)
          example: SecurePassword123
          minLength: 8
          maxLength: 100
        phone:
          type: string
          description: Phone number (optional)
          example: "+1234567890"
          nullable: true
      required:
        - name
        - email
        - password

    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Email address
          example: admin@drybros.com
        password:
          type: string
          format: password
          description: Password
          example: SecurePassword123
      required:
        - email
        - password

    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: User ID (UUID)
        fullName:
          type: string
          description: Full name
        email:
          type: string
          format: email
          description: Email address
        phone:
          type: string
          nullable: true
          description: Phone number
        role:
          type: string
          enum: [ADMIN, DRIVER, STAFF, CUSTOMER]
          description: User role
        isActive:
          type: boolean
          description: Whether the user is active

    RegisterAdminResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Admin registered successfully"

    AuthResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            accessToken:
              type: string
              description: JWT access token (expires in 1 hour)
            refreshToken:
              type: string
              description: JWT refresh token (expires in 8 hours)
            user:
              $ref: "#/components/schemas/User"

    ForgotPasswordRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Email address of the account
          example: admin@drybros.com
      required:
        - email

    ForgotPasswordResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Password reset link has been sent to your email address."

    ResetPasswordRequest:
      type: object
      properties:
        token:
          type: string
          description: Password reset token received via email (expires in 1 hour)
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        password:
          type: string
          format: password
          description: New password (minimum 8 characters)
          example: "NewSecurePassword123"
          minLength: 8
          maxLength: 100
      required:
        - token
        - password

    ResetPasswordResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Password has been reset successfully. Please check your email for confirmation."

    RefreshTokenRequest:
      type: object
      properties:
        refreshToken:
          type: string
          description: Refresh token received from login (expires in 8 hours)
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      required:
        - refreshToken

    CreateStaffRequest:
      type: object
      properties:
        name:
          type: string
          description: Full name of the staff member
          example: "John Doe"
          minLength: 1
          maxLength: 100
        email:
          type: string
          format: email
          description: Email address (must be unique, used for login)
          example: "john.doe@drybros.com"
          maxLength: 255
        phone:
          type: string
          description: Phone number (must be unique)
          example: "+1234567890"
          minLength: 10
          maxLength: 20
        password:
          type: string
          format: password
          description: Password (auto-generated from frontend, minimum 8 characters)
          example: "SecurePassword123"
          minLength: 8
          maxLength: 100
        franchiseId:
          type: string
          format: uuid
          description: Franchise ID (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        monthlySalary:
          type: number
          description: Monthly salary
          example: 50000
          minimum: 0
        address:
          type: string
          description: Full address
          example: "123 Main St, City, State 12345"
          minLength: 1
          maxLength: 500
        emergencyContact:
          type: string
          description: Emergency contact phone number
          example: "+1234567890"
          minLength: 10
          maxLength: 20
        emergencyContactRelation:
          type: string
          description: Relationship with emergency contact
          example: "Spouse"
          minLength: 1
          maxLength: 50
        govtId:
          type: boolean
          description: Whether government ID document is collected (checkbox)
          example: true
          default: false
        addressProof:
          type: boolean
          description: Whether address proof document is collected (checkbox)
          example: true
          default: false
        certificates:
          type: boolean
          description: Whether certificates are collected (checkbox)
          example: true
          default: false
        previousExperienceCert:
          type: boolean
          description: Whether previous experience certificate is collected (checkbox)
          example: true
          default: false
        profilePic:
          type: string
          nullable: true
          description: Profile picture URL (optional, for future use)
          example: "https://example.com/images/profile.jpg"
          maxLength: 500
          format: uri
        joinDate:
          type: string
          format: date-time
          description: Date when staff member joined (defaults to current date if not provided)
          example: "2024-01-15T00:00:00Z"
      required:
        - name
        - email
        - phone
        - password
        - franchiseId
        - monthlySalary
        - address
        - emergencyContact
        - emergencyContactRelation

    Staff:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Staff ID (UUID)
        name:
          type: string
          description: Full name
        email:
          type: string
          format: email
          description: Email address (used for login)
        phone:
          type: string
          description: Phone number
        franchiseId:
          type: string
          format: uuid
          description: Franchise ID
        monthlySalary:
          type: number
          description: Monthly salary
        address:
          type: string
          description: Full address
        emergencyContact:
          type: string
          description: Emergency contact phone number
        emergencyContactRelation:
          type: string
          description: Relationship with emergency contact
        govtId:
          type: boolean
          description: Whether government ID document is collected
        addressProof:
          type: boolean
          description: Whether address proof document is collected
        certificates:
          type: boolean
          description: Whether certificates are collected
        previousExperienceCert:
          type: boolean
          description: Whether previous experience certificate is collected
        profilePic:
          type: string
          nullable: true
          description: Profile picture URL
          format: uri
        status:
          type: string
          enum: [ACTIVE, FIRED, SUSPENDED, BLOCKED]
          description: Staff status
          example: ACTIVE
        suspendedUntil:
          type: string
          format: date-time
          nullable: true
          description: Suspension end date (only set when status is SUSPENDED)
        joinDate:
          type: string
          format: date-time
          description: Date when staff member joined the organization
          example: "2024-01-15T00:00:00Z"
        relieveDate:
          type: string
          format: date-time
          nullable: true
          description: Date when staff member was relieved/terminated
          example: "2024-12-31T00:00:00Z"
        relieveReason:
          type: string
          enum: [RESIGNATION, TERMINATION, RETIREMENT, CONTRACT_ENDED, PERFORMANCE_ISSUES, MISCONDUCT, OTHER]
          nullable: true
          description: Reason for relieving the staff member
          example: RESIGNATION
        isActive:
          type: boolean
          description: Whether the staff member is active
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp

    CreateStaffResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Staff member created successfully"
        data:
          $ref: "#/components/schemas/Staff"

    UpdateStaffRequest:
      type: object
      description: All fields are optional. Only provided fields will be updated.
      properties:
        name:
          type: string
          description: Full name of the staff member
          example: "John Doe"
          minLength: 1
          maxLength: 100
        email:
          type: string
          format: email
          description: Email address (must be unique if changed)
          example: "john.doe@drybros.com"
          maxLength: 255
        phone:
          type: string
          description: Phone number (must be unique if changed)
          example: "+1234567890"
          minLength: 10
          maxLength: 20
        franchiseId:
          type: string
          format: uuid
          description: Franchise ID (UUID) - allows reassigning to different franchise
          example: "550e8400-e29b-41d4-a716-446655440000"
        monthlySalary:
          type: number
          description: Monthly salary
          example: 50000
          minimum: 0
        address:
          type: string
          description: Full address
          example: "123 Main St, City, State 12345"
          minLength: 1
          maxLength: 500
        emergencyContact:
          type: string
          description: Emergency contact phone number
          example: "+1234567890"
          minLength: 10
          maxLength: 20
        emergencyContactRelation:
          type: string
          description: Relationship with emergency contact
          example: "Spouse"
          minLength: 1
          maxLength: 50
        govtId:
          type: boolean
          description: Whether government ID document is collected
          example: true
        addressProof:
          type: boolean
          description: Whether address proof document is collected
          example: true
        certificates:
          type: boolean
          description: Whether certificates are collected
          example: true
        previousExperienceCert:
          type: boolean
          description: Whether previous experience certificate is collected
          example: true
        profilePic:
          type: string
          nullable: true
          description: Profile picture URL
          example: "https://example.com/images/profile.jpg"
          maxLength: 500
          format: uri
        relieveDate:
          type: string
          format: date-time
          nullable: true
          description: Date when staff member was relieved/terminated
          example: "2024-12-31T00:00:00Z"
        relieveReason:
          type: string
          enum: [RESIGNATION, TERMINATION, RETIREMENT, CONTRACT_ENDED, PERFORMANCE_ISSUES, MISCONDUCT, OTHER]
          nullable: true
          description: Reason for relieving the staff member
          example: RESIGNATION
        isActive:
          type: boolean
          description: Whether the staff member is active
          example: true

    UpdateStaffStatusRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [FIRED, SUSPENDED, BLOCKED, ACTIVE]
          description: |
            The new status for the staff member.
            - FIRED: Terminates the staff member
            - SUSPENDED: Suspends the staff member (can optionally set suspendedUntil)
            - BLOCKED: Blocks the staff member from accessing the system
            - ACTIVE: Reactivates a previously suspended/blocked/fired staff member
          example: SUSPENDED
        suspendedUntil:
          type: string
          format: date-time
          nullable: true
          description: |
            Optional suspension end date. Only valid when status is SUSPENDED.
            If not provided when status is SUSPENDED, the suspension is indefinite.
          example: "2024-02-01T00:00:00Z"

    StaffStatusResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Staff member has been fired"
        data:
          $ref: "#/components/schemas/Staff"

    StaffHistory:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: History entry ID
        staffId:
          type: string
          format: uuid
          description: Staff member ID
        action:
          type: string
          description: Action performed (e.g., CREATED, UPDATED, DELETED, STATUS_CHANGED)
          example: "UPDATED"
        description:
          type: string
          nullable: true
          description: Detailed description of the action
          example: "Staff member John Doe updated"
        changedBy:
          type: string
          nullable: true
          description: User ID who made the change
          example: "550e8400-e29b-41d4-a716-446655440000"
        oldValue:
          type: string
          nullable: true
          description: JSON string of old values before the change
          example: '{"name":"John Doe","email":"john@example.com"}'
        newValue:
          type: string
          nullable: true
          description: JSON string of new values after the change
          example: '{"name":"John Smith","email":"john.smith@example.com"}'
        createdAt:
          type: string
          format: date-time
          description: When the action was performed
          example: "2024-01-20T10:30:00Z"

    StaffHistoryResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/StaffHistory"
          description: List of staff history entries, ordered by most recent first

    PaginatedStaffResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/Staff"
          description: List of staff members for the current page
        pagination:
          type: object
          properties:
            page:
              type: integer
              description: Current page number
              example: 1
            limit:
              type: integer
              description: Number of items per page
              example: 10
            total:
              type: integer
              description: Total number of staff members
              example: 50
            totalPages:
              type: integer
              description: Total number of pages
              example: 5
            hasNext:
              type: boolean
              description: Whether there is a next page
              example: true
            hasPrev:
              type: boolean
              description: Whether there is a previous page
              example: false
          required:
            - page
            - limit
            - total
            - totalPages
            - hasNext
            - hasPrev

    Franchise:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Franchise ID (UUID)
          example: "550e8400-e29b-41d4-a716-446655440000"
        code:
          type: string
          description: Auto-generated unique franchise code (format: FRN-XXXXXX)
          example: "FRN-A1B2C3"
        name:
          type: string
          description: Franchise name
          example: "Downtown Branch"
        city:
          type: string
          description: City (kept for backward compatibility)
          example: "New York"
        region:
          type: string
          nullable: true
          description: Region where franchise is located
          example: "New York"
        address:
          type: string
          nullable: true
          description: Physical address of the franchise
          example: "123 Main Street, New York, NY 10001"
        phone:
          type: string
          nullable: true
          description: Contact number
          example: "+1234567890"
        inchargeName:
          type: string
          nullable: true
          description: Name of the person in charge
          example: "John Smith"
        storeImage:
          type: string
          nullable: true
          description: Store image URL
          example: "https://example.com/images/store.jpg"
        legalDocumentsCollected:
          type: boolean
          description: Flag indicating if legal documents have been collected
          example: false
        status:
          type: string
          enum: [ACTIVE, BLOCKED, TEMPORARILY_CLOSED]
          description: Franchise status
          example: "ACTIVE"
        isActive:
          type: boolean
          description: Whether the franchise is active
          example: true
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-20T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-20T10:30:00Z"

    CreateFranchiseRequest:
      type: object
      required:
        - name
        - region
        - address
        - phone
        - inchargeName
        - managerEmail
        - managerPhone
      properties:
        name:
          type: string
          description: Franchise name
          example: "Downtown Branch"
          minLength: 1
          maxLength: 100
        region:
          type: string
          description: Region where franchise is located
          example: "New York"
          minLength: 1
          maxLength: 100
        address:
          type: string
          description: Physical address of the franchise
          example: "123 Main Street, New York, NY 10001"
          minLength: 1
          maxLength: 500
        phone:
          type: string
          description: Contact number
          example: "+1234567890"
          minLength: 10
          maxLength: 20
        inchargeName:
          type: string
          description: Name of the person in charge
          example: "John Smith"
          minLength: 1
          maxLength: 100
        managerEmail:
          type: string
          format: email
          description: Email address of the manager (will be used to create manager user account)
          example: "john.smith@drybros.com"
          maxLength: 255
        managerPhone:
          type: string
          description: Phone number of the manager
          example: "+1234567891"
          pattern: "^[+]?[(]?[0-9]{1,4}[)]?[-\\s.]?[(]?[0-9]{1,4}[)]?[-\\s.]?[0-9]{1,9}$"
          minLength: 10
          maxLength: 20
        storeImage:
          type: string
          format: uri
          nullable: true
          description: Store image URL (optional)
          example: "https://example.com/images/store.jpg"
          maxLength: 500
        legalDocumentsCollected:
          type: boolean
          description: Flag indicating if legal documents have been collected
          example: false
          default: false

    CreateFranchiseResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Franchise created successfully"
        data:
          $ref: "#/components/schemas/Franchise"

    UpdateFranchiseRequest:
      type: object
      description: All fields are optional - only provide fields you want to update
      properties:
        name:
          type: string
          description: Franchise name
          example: "Updated Downtown Branch"
          minLength: 1
          maxLength: 100
        region:
          type: string
          description: Region where franchise is located
          example: "New York City"
          minLength: 1
          maxLength: 100
        address:
          type: string
          description: Physical address of the franchise
          example: "456 Updated Street, New York, NY 10002"
          minLength: 1
          maxLength: 500
        phone:
          type: string
          description: Contact number
          example: "+1234567891"
          pattern: "^[+]?[(]?[0-9]{1,4}[)]?[-\\s.]?[(]?[0-9]{1,4}[)]?[-\\s.]?[0-9]{1,9}$"
          minLength: 10
          maxLength: 20
        inchargeName:
          type: string
          description: Name of the person in charge
          example: "Jane Doe"
          minLength: 1
          maxLength: 100
        storeImage:
          type: string
          format: uri
          nullable: true
          description: Store image URL (optional)
          example: "https://example.com/images/store-updated.jpg"
          maxLength: 500
        legalDocumentsCollected:
          type: boolean
          description: Flag indicating if legal documents have been collected
          example: true

    UpdateFranchiseStatusRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [ACTIVE, BLOCKED, TEMPORARILY_CLOSED]
          description: New franchise status
          example: "BLOCKED"

    PaginationMeta:
      type: object
      description: Pagination metadata
      properties:
        page:
          type: integer
          description: Current page number
          example: 1
        limit:
          type: integer
          description: Number of items per page
          example: 10
        total:
          type: integer
          description: Total number of items
          example: 25
        totalPages:
          type: integer
          description: Total number of pages
          example: 3
        hasNext:
          type: boolean
          description: Whether there is a next page
          example: true
        hasPrev:
          type: boolean
          description: Whether there is a previous page
          example: false

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: "Account is temporarily locked due to multiple failed login attempts. Please try again in 5 minute(s)."

    CreateDriverRequest:
      type: object
      required:
        - firstName
        - lastName
        - phone
        - email
        - password
        - emergencyContactName
        - emergencyContactPhone
        - emergencyContactRelation
        - address
        - city
        - state
        - pincode
        - licenseNumber
        - licenseExpDate
        - bankAccountName
        - bankAccountNumber
        - bankIfscCode
        - carTypes
        - franchiseId
      properties:
        firstName:
          type: string
          description: Driver's first name
          example: "John"
        lastName:
          type: string
          description: Driver's last name
          example: "Doe"
        phone:
          type: string
          description: Primary phone number (must be unique)
          example: "+1234567890"
        email:
          type: string
          format: email
          description: Email address (must be unique)
          example: "john.doe@example.com"
        altPhone:
          type: string
          description: Alternate phone number (optional)
          example: "+1234567891"
        password:
          type: string
          minLength: 6
          description: Password for web login (auto-generated from frontend, will be used for both app and web login)
          example: "SecurePass123!"
        emergencyContactName:
          type: string
          description: Emergency contact person's name
          example: "Jane Doe"
        emergencyContactPhone:
          type: string
          description: Emergency contact phone number
          example: "+1234567892"
        emergencyContactRelation:
          type: string
          description: Relationship with emergency contact
          example: "Spouse"
        address:
          type: string
          description: Street address
          example: "123 Main Street"
        city:
          type: string
          description: City
          example: "New York"
        state:
          type: string
          description: State
          example: "NY"
        pincode:
          type: string
          minLength: 6
          description: Postal/ZIP code
          example: "10001"
        licenseNumber:
          type: string
          description: Driving license number
          example: "DL1234567890"
        licenseExpDate:
          type: string
          format: date-time
          description: License expiration date (must be in future)
          example: "2025-12-31T00:00:00Z"
        bankAccountName:
          type: string
          description: Bank account holder name
          example: "John Doe"
        bankAccountNumber:
          type: string
          description: Bank account number
          example: "1234567890"
        bankIfscCode:
          type: string
          description: Bank IFSC code
          example: "BANK0001234"
        aadharCard:
          type: boolean
          default: false
          description: Aadhar card collected
          example: true
        license:
          type: boolean
          default: false
          description: License document collected
          example: true
        educationCert:
          type: boolean
          default: false
          description: Education certificate collected
          example: false
        previousExp:
          type: boolean
          default: false
          description: Previous experience certificate collected
          example: true
        carTypes:
          type: array
          items:
            type: string
            enum: [MANUAL, AUTOMATIC, PREMIUM_CARS, LUXURY_CARS, SPORTY_CARS]
          minItems: 1
          description: Types of cars the driver can drive
          example: ["MANUAL", "AUTOMATIC"]
        franchiseId:
          type: integer
          description: Franchise ID (for now use dummy UUID as integer)
          example: 1

    Driver:
      type: object
      properties:
        id:
          type: integer
          description: Driver ID
          example: 1
        franchiseId:
          type: integer
          description: Franchise ID
          example: 1
        firstName:
          type: string
          description: Driver's first name
          example: "John"
        lastName:
          type: string
          description: Driver's last name
          example: "Doe"
        phone:
          type: string
          description: Primary phone number
          example: "+1234567890"
        email:
          type: string
          format: email
          description: Email address
          example: "john.doe@example.com"
        altPhone:
          type: string
          nullable: true
          description: Alternate phone number
          example: "+1234567891"
        driverCode:
          type: string
          description: Auto-generated unique driver code for app login (format: DRV-XXXXXX)
          example: "DRV-A1B2C3"
        emergencyContactName:
          type: string
          description: Emergency contact person's name
          example: "Jane Doe"
        emergencyContactPhone:
          type: string
          description: Emergency contact phone number
          example: "+1234567892"
        emergencyContactRelation:
          type: string
          description: Relationship with emergency contact
          example: "Spouse"
        address:
          type: string
          description: Street address
          example: "123 Main Street"
        city:
          type: string
          description: City
          example: "New York"
        state:
          type: string
          description: State
          example: "NY"
        pincode:
          type: string
          description: Postal/ZIP code
          example: "10001"
        licenseNumber:
          type: string
          description: Driving license number
          example: "DL1234567890"
        licenseExpDate:
          type: string
          format: date-time
          description: License expiration date
          example: "2025-12-31T00:00:00Z"
        bankAccountName:
          type: string
          description: Bank account holder name
          example: "John Doe"
        bankAccountNumber:
          type: string
          description: Bank account number
          example: "1234567890"
        bankIfscCode:
          type: string
          description: Bank IFSC code
          example: "BANK0001234"
        aadharCard:
          type: boolean
          description: Aadhar card collected
          example: true
        license:
          type: boolean
          description: License document collected
          example: true
        educationCert:
          type: boolean
          description: Education certificate collected
          example: false
        previousExp:
          type: boolean
          description: Previous experience certificate collected
          example: true
        carTypes:
          type: array
          items:
            type: string
            enum: [MANUAL, AUTOMATIC, PREMIUM_CARS, LUXURY_CARS, SPORTY_CARS]
          description: Types of cars the driver can drive
          example: ["MANUAL", "AUTOMATIC"]
        status:
          type: string
          enum: [ACTIVE, INACTIVE, BLOCKED, TERMINATED]
          description: Driver status
          example: "ACTIVE"
        complaintCount:
          type: integer
          description: Number of complaints against the driver
          example: 0
        bannedGlobally:
          type: boolean
          description: Whether the driver is banned globally
          example: false
        dailyTargetAmount:
          type: integer
          nullable: true
          description: Daily target amount for the driver
          example: 5000
        currentRating:
          type: number
          format: float
          nullable: true
          description: Current rating of the driver
          example: 4.5
        createdBy:
          type: integer
          nullable: true
          description: User ID who created this driver
          example: 1
        createdAt:
          type: string
          format: date-time
          description: When the driver was created
          example: "2024-01-20T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: When the driver was last updated
          example: "2024-01-20T10:30:00Z"

    CreateDriverResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Driver created successfully"
        data:
          $ref: "#/components/schemas/Driver"

    UpdateDriverRequest:
      type: object
      description: All fields are optional for partial updates. At least one field must be provided.
      properties:
        firstName:
          type: string
          description: Driver's first name
          example: "John"
        lastName:
          type: string
          description: Driver's last name
          example: "Smith"
        phone:
          type: string
          description: Primary phone number
          example: "+1234567890"
        email:
          type: string
          format: email
          description: Email address
          example: "john.smith@example.com"
        altPhone:
          type: string
          nullable: true
          description: Alternate phone number
          example: "+1234567891"
        password:
          type: string
          format: password
          description: Password (will be hashed before storage)
          example: "NewSecurePass123!"
        emergencyContactName:
          type: string
          description: Emergency contact person's name
          example: "Jane Smith"
        emergencyContactPhone:
          type: string
          description: Emergency contact phone number
          example: "+1234567892"
        emergencyContactRelation:
          type: string
          description: Relationship with emergency contact
          example: "Spouse"
        address:
          type: string
          description: Street address
          example: "456 Oak Avenue"
        city:
          type: string
          description: City
          example: "Los Angeles"
        state:
          type: string
          description: State
          example: "CA"
        pincode:
          type: string
          description: Postal/ZIP code
          example: "90001"
        licenseNumber:
          type: string
          description: Driving license number
          example: "DL9876543210"
        licenseExpDate:
          type: string
          format: date-time
          description: License expiration date (must be in the future)
          example: "2026-12-31T00:00:00Z"
        bankAccountName:
          type: string
          description: Bank account holder name
          example: "John Smith"
        bankAccountNumber:
          type: string
          description: Bank account number
          example: "9876543210"
        bankIfscCode:
          type: string
          description: Bank IFSC code
          example: "BANK0005678"
        aadharCard:
          type: boolean
          description: Aadhar card collected
          example: true
        license:
          type: boolean
          description: License document collected
          example: true
        educationCert:
          type: boolean
          description: Education certificate collected
          example: false
        previousExp:
          type: boolean
          description: Previous experience certificate collected
          example: true
        carTypes:
          type: array
          items:
            type: string
            enum: [MANUAL, AUTOMATIC, PREMIUM_CARS, LUXURY_CARS, SPORTY_CARS]
          description: Types of cars the driver can drive
          example: ["MANUAL", "AUTOMATIC"]
        franchiseId:
          type: string
          format: uuid
          description: Franchise ID (for reassigning driver to different franchise)
          example: "550e8400-e29b-41d4-a716-446655440001"
        status:
          type: string
          enum: [ACTIVE, INACTIVE, BLOCKED, TERMINATED]
          description: Driver status
          example: "ACTIVE"

    UpdateDriverResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Driver updated successfully"
        data:
          $ref: "#/components/schemas/Driver"

    UpdateDriverStatusRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [ACTIVE, INACTIVE, BLOCKED, TERMINATED]
          description: |
            Driver status:
            - ACTIVE: Reactivate driver
            - INACTIVE: Suspend driver (temporarily disable)
            - BLOCKED: Block driver (prevent access)
            - TERMINATED: Fire/terminate driver (permanent removal)
          example: "INACTIVE"

    UpdateDriverStatusResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message with status change description
          example: "Driver has been suspended (inactive)"
        data:
          $ref: "#/components/schemas/Driver"

    PaginationInfo:
      type: object
      properties:
        page:
          type: integer
          description: Current page number
          example: 1
        limit:
          type: integer
          description: Number of items per page
          example: 10
        total:
          type: integer
          description: Total number of items
          example: 50
        totalPages:
          type: integer
          description: Total number of pages
          example: 5
        hasNext:
          type: boolean
          description: Whether there is a next page
          example: true
        hasPrev:
          type: boolean
          description: Whether there is a previous page
          example: false

    DriverLoginRequest:
      type: object
      required:
        - driverCode
        - password
      properties:
        driverCode:
          type: string
          description: Driver code (format: DRV-XXXXXX)
          example: "DRV-3ZSQIA"
        password:
          type: string
          format: password
          description: Driver password
          example: "SecurePass123!"

    DriverLoginResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT access token (expires in 1 hour)
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        refreshToken:
          type: string
          description: JWT refresh token (expires in 8 hours)
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        driver:
          type: object
          properties:
            id:
              type: string
              format: uuid
              description: Driver ID
              example: "550e8400-e29b-41d4-a716-446655440000"
            driverCode:
              type: string
              description: Driver code
              example: "DRV-3ZSQIA"
            firstName:
              type: string
              description: Driver's first name
              example: "John"
            lastName:
              type: string
              description: Driver's last name
              example: "Doe"
            email:
              type: string
              format: email
              description: Driver's email address
              example: "john.doe@example.com"
            phone:
              type: string
              description: Driver's phone number
              example: "+1234567890"
            status:
              type: string
              enum: [ACTIVE, INACTIVE, BLOCKED, TERMINATED]
              description: Driver status
              example: "ACTIVE"

    LogoutResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: "Logged out successfully"

    CurrentUserResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            id:
              type: string
              format: uuid
              description: User ID
            fullName:
              type: string
              description: User's full name
            email:
              type: string
              format: email
              description: User's email address
            phone:
              type: string
              nullable: true
              description: User's phone number
            role:
              type: string
              enum: [ADMIN, DRIVER, STAFF, CUSTOMER, OFFICE_STAFF]
              description: User role
            isActive:
              type: boolean
              description: Whether the user account is active

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from login endpoint
